11. can u please write logic in s ansible if another server pinging fine we can transfer file source server to another server 
and if server not ping we cant transfer
1ï¸âƒ£ Ansible Control Node Setup
Requirement	Explanation
âœ… Ansible Installed	Install Ansible on control machine
âœ… SSH access to target servers	Control node must be able to SSH to all target servers
âœ… SSH Key setup (recommended)	Set up passwordless SSH using keys
âœ… Python installed on remote servers	Ansible requires Python on managed nodes
âœ… Correct inventory/vars configured	Have the correct server IPs, usernames, file paths
========================================================
===============
Explanation:
This playbook runs locally on the control machine (hosts: localhost).

We're not running this playbook on the remote servers directly. Instead, we're using delegate_to to interact with remote servers after doing checks.

gather_facts: no disables fact collection to speed up execution (since we donâ€™t need system facts from localhost).

yaml
Copy
Edit
  vars:
    dest_servers:
      - 192.168.1.100
      - 192.168.1.101
      - 192.168.1.102
    source_file: /path/to/source/file.txt
    dest_user: remoteuser
    dest_path: /path/to/destination/
âœ… Explanation:
Here we define variables:

dest_servers: list of IP addresses (servers where we want to transfer file if reachable)

source_file: file to transfer (from Ansible control machine)

dest_user: user account on destination servers

dest_path: destination path on remote servers

yaml
Copy
Edit
  tasks:
    - name: Loop through servers
      block:
âœ… Explanation:
This task uses a block, which groups multiple tasks that will be executed for each server in the list.

ğŸ”„ The LOOP starts here:
yaml
Copy
Edit
      loop: "{{ dest_servers }}"
We iterate over each server IP stored in dest_servers list.

âœ… Inside the block, the following tasks are executed for each server:
ğŸ”¹ 1st Task: Ping Check
yaml
Copy
Edit
        - name: Check if server {{ item }} is reachable
          shell: "ping -c 2 {{ item }}"
          register: ping_result
          ignore_errors: yes
Runs ping -c 2 for the current item (server IP in loop).

register: ping_result saves the output (exit code and stdout/stderr).

ignore_errors: yes â€” prevents the playbook from failing if ping fails (because we want to continue to next condition).

ğŸ”¹ 2nd Task: File Transfer (only if ping was successful)
yaml
Copy
Edit
        - name: Transfer file if ping successful
          when: ping_result.rc == 0
          delegate_to: "{{ item }}"
          copy:
            src: "{{ source_file }}"
            dest: "{{ dest_path }}"
          become: yes
          remote_user: "{{ dest_user }}"
âœ… Key details:

when: ping_result.rc == 0 â€” only runs if ping returned exit code 0 (successful).

delegate_to: "{{ item }}" â€” very important!

This means that Ansible connects directly to the remote server only for this task.

copy: module â€” copies the file from the control machine to the remote server.

become: yes â€” elevate privileges (use sudo if required).

remote_user: "{{ dest_user }}" â€” defines SSH user for remote connection.

ğŸ”¹ 3rd Task: Print message if server not reachable
yaml
Copy
Edit
        - name: Print message if server is not reachable
          when: ping_result.rc != 0
          debug:
            msg: "Server {{ item }} is not reachable. Skipping file transfer."
âœ… Explanation:

Only runs if ping failed (rc != 0)

Just prints a message saying that file transfer will be skipped for this server.==========
==========================================================================
ansible-project/
â”‚
â”œâ”€â”€ inventory/
â”‚   â””â”€â”€ inventory.ini         <-- Inventory file
â”‚
â”œâ”€â”€ playbooks/
â”‚   â””â”€â”€ file_transfer.yml     <-- Your main playbook
â”‚
â”œâ”€â”€ files/
â”‚   â””â”€â”€ file.txt              <-- Source file to transfer
â”‚
â”œâ”€â”€ roles/
â”‚   â””â”€â”€ file_transfer/        <-- Create role for better modularity
â”‚       â”œâ”€â”€ tasks/
â”‚       â”‚   â””â”€â”€ main.yml
â”‚       â”œâ”€â”€ vars/
â”‚       â”‚   â””â”€â”€ main.yml
â”‚       â”œâ”€â”€ handlers/
â”‚       â”‚   â””â”€â”€ main.yml
â”‚       â””â”€â”€ templates/
â”‚
â”œâ”€â”€ group_vars/
â”‚   â””â”€â”€ app_servers.yml       <-- Group-level variables
â”‚
â”œâ”€â”€ ansible.cfg               <-- Global config file (optional)
â””â”€â”€ README.md
===============================simple playbook for single server===========================================
---
- name: File Transfer Automation
  hosts: app_servers
  become: yes

  tasks:
    - name: Copy file to target servers
      copy:
        src: "../files/file.txt"
        dest: "/opt/file.txt"
====================================================
---
- name: Transfer file to multiple servers if reachable
  hosts: localhost
  gather_facts: no
  vars:
    dest_servers:
      - 192.168.1.100
      - 192.168.1.101
      - 192.168.1.102
    source_file: /path/to/source/file.txt
    dest_user: remoteuser
    dest_path: /path/to/destination/

  tasks:
    - name: Loop through servers
      block:
        - name: Check if server {{ item }} is reachable
          shell: "ping -c 2 {{ item }}"
          register: ping_result
          ignore_errors: yes

        - name: Transfer file if ping successful
          when: ping_result.rc == 0
          delegate_to: "{{ item }}"
          copy:
            src: "{{ source_file }}"
            dest: "{{ dest_path }}"
          become: yes
          remote_user: "{{ dest_user }}"

        - name: Print message if server is not reachable
          when: ping_result.rc != 0
          debug:
            msg: "Server {{ item }} is not reachable. Skipping file transfer."
      loop: "{{ dest_servers }}"
=================================Create Inventory File
inventory/inventory.ini
[dest_servers]
192.168.1.100 ansible_user=remoteuser
192.168.1.101 ansible_user=remoteuser
192.168.1.102 ansible_user=remoteuser
=================playbook.yaml
- name: Transfer file to multiple servers if reachable
  hosts: dest_servers
  gather_facts: no
  tasks:

    - name: Check if server is reachable
      shell: "ping -c 2 {{ inventory_hostname }}"
      register: ping_result
      ignore_errors: yes

    - name: Transfer file if ping successful
      when: ping_result.rc == 0
      copy:
        src: /path/to/source/file.txt
        dest: /path/to/destination/file.txt
      become: yes

    - name: Print message if server is not reachable
      when: ping_result.rc != 0
      debug:
        msg: "Server {{ inventory_hostname }} is not reachable. Skipping file transfer."
------------------------------------
